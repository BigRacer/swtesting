http://sqlfiddle.com/#!4/06c18/0